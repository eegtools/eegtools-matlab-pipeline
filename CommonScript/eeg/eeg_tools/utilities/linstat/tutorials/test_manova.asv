function test_manova
try
    load manova_test_results


    %% test 1 way manova
    % example using carbig
    load carbig;        % load data
    X = [MPG Acceleration Weight Displacement];  % response variables
    glm = encode( X, 3, 1, Origin );             % Origin is explanatory variable
    m   = manova( glm );                         % manova
    anova_compare( m, m1 );


    %% test 2nd order 2- way manova
    % example using dog. These results are equivalent
    % to the results obtained using JMP5 (and 6) using 
    % an Identity M Matrix. However, 
    % I don't calculate the effect of the intercept
    load dog;        % load data
    glm = encode( x, 3, 2, drug, dep);
    m   = manova( glm );                       % manova
    anova_compare( m, m2 );

    %% using repeated measures (within subjects effects)
    % example using dog
    % This is equivalent to the withinsubjects interactions
    % calculated in SAS/JMP repeated measures anova
    % In their nomenclature the columns represent time and
    % these effects can be thought of as the interactions 
    % with time. So the "drug" effect becomes the time*drug effect after
    % the M-transformed data. The "drug*dep" becomes the time*drug*dep
    % effect after transfoming, etc. 
    load dog
    M  = getcontrasts( 4, 3 );
    glm = encode( x*M, 3, 2, drug, dep );
    m = manova(glm);
    
    
    % Between subjects effects
    load dog
    M   = ones( 4, 1);
    glm = encode(x*M, 3,2,drug,dep);
    m   = anova(glm);       % there is only one variable, so anova is correct. 
    % if fact, manova results aren't equivalent, and I don't yet know why.
    
    disp('manova: passed');
catch
    disp('manova: failed' );
end;

